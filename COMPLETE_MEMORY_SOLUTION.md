# üö® –ü–æ–ª–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å –ø–∞–º—è—Ç—å—é –ø—Ä–∏ —Å–±–æ—Ä–∫–µ React

## –ü—Ä–æ–±–ª–µ–º–∞
–°–µ—Ä–≤–µ—Ä –Ω–µ –∏–º–µ–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–∞–º—è—Ç–∏ –¥–ª—è —Å–±–æ—Ä–∫–∏ React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ.

## üöÄ –†–µ—à–µ–Ω–∏—è (–ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É)

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
git pull
chmod +x solve-memory-issues.sh
./solve-memory-issues.sh
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø–æ–ø—Ä–æ–±—É–µ—Ç –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

### 2. –°–±–æ—Ä–∫–∞ –Ω–∞ —Ö–æ—Å—Ç–µ (—Å–∞–º–æ–µ –Ω–∞–¥–µ–∂–Ω–æ–µ)

```bash
# 1. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥
git pull

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Node.js (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# 3. –°–æ–±—Ä–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —Ö–æ—Å—Ç–µ
chmod +x build-on-host.sh
./build-on-host.sh

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º Docker
docker-compose -f docker-compose.minimal.yml up -d
```

### 3. –°–æ–∑–¥–∞–Ω–∏–µ swap —Ñ–∞–π–ª–∞

```bash
# –°–æ–∑–¥–∞—Ç—å swap —Ñ–∞–π–ª 4GB
sudo fallocate -l 4G /swapfile
sudo chmod 600 /swapfile
sudo mkswap /swapfile
sudo swapon /swapfile

# –°–¥–µ–ª–∞—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º
echo '/swapfile none swap sw 0 0' | sudo tee -a /etc/fstab

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
free -h

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å
docker-compose -f docker-compose.prod.yml up --build -d
```

### 4. –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ Docker

```bash
# –°–æ–∑–¥–∞—Ç—å –∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å /etc/docker/daemon.json
sudo tee /etc/docker/daemon.json > /dev/null <<EOF
{
  "default-ulimits": {
    "memlock": {
      "Hard": -1,
      "Name": "memlock",
      "Soft": -1
    }
  },
  "log-driver": "json-file",
  "log-opts": {
    "max-size": "10m",
    "max-file": "3"
  }
}
EOF

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Docker
sudo systemctl restart docker

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å
docker-compose -f docker-compose.prod.yml up --build -d
```

### 5. –°–±–æ—Ä–∫–∞ –Ω–∞ –¥—Ä—É–≥–æ–º —Å–µ—Ä–≤–µ—Ä–µ

–ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç, —Å–æ–±–µ—Ä–∏—Ç–µ –Ω–∞ –±–æ–ª–µ–µ –º–æ—â–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ:

```bash
# –ù–∞ –º–æ—â–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ:
git clone https://github.com/Garanash/agb-searcher.git
cd agb-searcher
cp env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env
docker-compose -f docker-compose.prod.yml up --build -d

# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≥–æ—Ç–æ–≤—ã–π build –Ω–∞ —Ü–µ–ª–µ–≤–æ–π —Å–µ—Ä–≤–µ—Ä:
docker save agb-searcher-frontend-prod | gzip > frontend.tar.gz
# –ü–µ—Ä–µ–Ω–µ—Å–∏—Ç–µ frontend.tar.gz –Ω–∞ —Ü–µ–ª–µ–≤–æ–π —Å–µ—Ä–≤–µ—Ä

# –ù–∞ —Ü–µ–ª–µ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ:
docker load < frontend.tar.gz
docker-compose -f docker-compose.prod.yml up -d
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
docker-compose -f docker-compose.prod.yml ps
# –∏–ª–∏
docker-compose -f docker-compose.minimal.yml ps

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É
curl -I http://localhost
curl http://localhost:8000/health

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞–º—è—Ç—å
free -h
docker stats
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤

```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
free -h

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ swap
swapon --show

# –ü—Ä–æ—Ü–µ—Å—Å—ã —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ–º –ø–∞–º—è—Ç–∏
ps aux --sort=-%mem | head -10

# Docker —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
docker stats --no-stream
```

## ‚ö†Ô∏è –ï—Å–ª–∏ –≤—Å–µ —Ä–µ—à–µ–Ω–∏—è –Ω–µ –ø–æ–º–æ–≥–∞—é—Ç

### –í–∞—Ä–∏–∞–Ω—Ç A: –£–≤–µ–ª–∏—á–∏—Ç—å RAM —Å–µ—Ä–≤–µ—Ä–∞
- –ú–∏–Ω–∏–º—É–º: 4GB RAM
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: 8GB+ RAM

### –í–∞—Ä–∏–∞–Ω—Ç B: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –º–æ—â–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –¥–ª—è —Å–±–æ—Ä–∫–∏
1. –°–æ–±—Ä–∞—Ç—å –Ω–∞ –º–æ—â–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ
2. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π –æ–±—Ä–∞–∑
3. –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ü–µ–ª–µ–≤–æ–π —Å–µ—Ä–≤–µ—Ä

### –í–∞—Ä–∏–∞–Ω—Ç C: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CI/CD
–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Å–±–æ—Ä–∫—É –≤ GitHub Actions –∏–ª–∏ –¥—Ä—É–≥–æ–º CI/CD —Å–µ—Ä–≤–∏—Å–µ.

## üéØ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ª—é–±–æ–≥–æ –∏–∑ —Ä–µ—à–µ–Ω–∏–π:
- ‚úÖ Frontend –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —É—Å–ø–µ—à–Ω–æ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ http://your-server-ip
- ‚úÖ API —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ http://your-server-ip:8000
- ‚úÖ Markdown —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —á–∞—Ç–µ
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ "out of memory"

## üìã –†–µ–∑—é–º–µ —Ä–µ—à–µ–Ω–∏–π

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç** - `solve-memory-issues.sh`
2. **–°–±–æ—Ä–∫–∞ –Ω–∞ —Ö–æ—Å—Ç–µ** - `build-on-host.sh` + `docker-compose.minimal.yml`
3. **Swap —Ñ–∞–π–ª** - –¥–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å < 4GB RAM
4. **–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ Docker** - –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
5. **–°–±–æ—Ä–∫–∞ –Ω–∞ –¥—Ä—É–≥–æ–º —Å–µ—Ä–≤–µ—Ä–µ** - –¥–ª—è –æ—á–µ–Ω—å —Å–ª–∞–±—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤

–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –≤–∞—Ä–∏–∞–Ω—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–∞—à–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤!
